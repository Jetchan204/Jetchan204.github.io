<!DOCTYPE html>
<html lang="en">
<title>Report | Low-Battery Level Detector</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> 
<link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif;}
.w3-sidebar {
  z-index: 3;
  width: 250px;
  top: 43px;
  bottom: 0;
  height: inherit;
}
</style>
<body>

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-theme w3-top w3-left-align w3-large">
<!--    <a class="w3-bar-item w3-button w3-right w3-hide-large w3-hover-white w3-large w3-theme-l1" 
		href="javascript:void(0)" onclick="w3_open()"><!--<i class="fa fa-bars"></i></a>	-->
    <a href="Low-Battery_Level_Detector.html#"><img src="Logo.jpeg" width="50" height="50" class="w3-bar-item w3-button"></a>
    <a href="Overview.html" class="w3-bar-item w3-button w3-hide-small w3-hover-red">Overview</a>
    <a href="#" class="w3-bar-item w3-button w3-hide-small w3-hover-yellow">Report</a>
    <a href="Appendix.html" class="w3-bar-item w3-button w3-hide-small w3-hover-green">Appendix</a>
    <a href="https://jetchan204.github.io/index.html" class="w3-bar-item w3-button w3-hide-small w3-hover-blue">Project List</a>
  </div>
</div>

<div class="w3-row w3-padding-64">
    <div class="w3-twothird w3-container">
	<h1 align="center"><b>Introduction</b></h1>
	<p> The objective of this design project was to produce a low-battery level detector. The low-battery circuit is powered by a 3.7 V lithium ion battery with a graphite anode.
		The specifications (both mandatory and optional) for a working design are as followed: </p>
	<p> <u>Mandatory</u>
		<ul>
			<li>&#9989; Warn of imminent failure (i.e. V<sub>Bat</sub> = 3.0 V)</li>
		</ul> 
		<u>Optional</u>
		<ul>
			<li>&#9989; Continuous read of % charge</li>
			<li>&#9989; Continuous sensing of battery current</li>
			<li>Temperature sensing</li>
			<li>Battery charging capability</li>
		</ul> </p>
	<p> The battery can’t be allowed to decrease below 2.4 V, or an internal chemical reaction will occur. This reaction will cause one of the battery electrodes to 
		oxidize/corrode through a process which can’t be reversed through recharging. Thus, the battery capacity will be lost and the cell may be completely destroyed. </p>
	<p> Li-Ion cells will not tolerate trickle charging (charging a fully charged battery at a rate equal to its self-discharge rate, thus enabling the battery to remain at 
		its fully charged level) after they are fully charged. Even if a small amount of current is continuously forced into a fully-charged Li-Ion cell, the cell will be damaged. 
		So this means that Li-Ion cells should be charged using constant-voltage (C-V) chargers, and not constant-current (C-C) chargers. </p>	
	<p> Batteries are acutely sensitive to operating temperature with respect to their charging characteristics and A-hr capacity. Most well-designed chargers have 
		temperature sensors to assure that the battery temperature is within the allowable “window” for charging (if not, the charger will not turn on the current source). 
		The Li-Ion cell can be safely charged at temperatures between 0 - 45&deg;C. The operating temperature range during discharge is specified as -20 to 60&deg;C. </p>	
	
	<h1 align="center"><b>Methods & Results</b></h1>
	<p>	The design of the Low-battery level indicator consisted of the lithium ion battery and the voltage comparator. <br /> 
		According to Figure 1, the build of a lithium ion battery was required to match the decaying curve of the graphite anode. </p> <br />
	<p align="center"><img src="Figure 1.JPG"></p>	
	<p align="center"><font size="-1"><i>Figure 1: Low-battery circuit with 3.7 V lithium ion battery</i></font></p> <br />
	
	<p> Within the Synopsis design tool, the Galaxy Custom Designer was implemented to perform this function and many others. <br /> 
		In Figure 2, the 3.7 V lithium ion battery was constructed with a "V<sub>PWL</sub>" (<u>P</u>iece<u>w</u>ise-<u>L</u>inear voltage source) cell,
		which consisted of 22 time value pairs. The time value pairs are displayed in Table 1. These pairs display the actual linear and exponential decay. </p> <br />
	<p align="center"><img src="Figure 2.jpg"></p>
	<p align="center"><font size="-1"><i>Figure 2: 3.7 V Lithium Ion battery as it appears in all schematics</i></font></p> <br />
	
	<table align="center" border="5%" width="25%">
		<tr>
			<th>Time 1 = 0 &micro;s</th>
			<th>Voltage 1 = 3.7 V</th>
		</tr>	
		<tr>	
			<th>Time 2 = 80 &micro;s</th>
			<th>Voltage 2 = 3.5 V</th>
		</tr>
		<tr>	
			<th>Time 3 = 81 &micro;s</th>
			<th>Voltage 3 = 3.5 V</th>
		</tr>
		<tr>	
			<th>Time 4 = 82 &micro;s</th>
			<th>Voltage 4 = 3.49 V</th>
		</tr>	
		<tr>	
			<th>Time 5 = 83 &micro;s</th>
			<th>Voltage 5 = 3.49 V</th>
		</tr>	
		<tr>	
			<th>Time 6 = 84 &micro;s</th>
			<th>Voltage 6 = 3.48 V</th>
		</tr>
		<tr>	
			<th>Time 7 = 85 &micro;s</th>
			<th>Voltage 7 = 3.48 V</th>
		</tr>	
		<tr>	
			<th>Time 8 = 86 &micro;s</th>
			<th>Voltage 8 = 3.47 V</th>
		</tr>	
		<tr>	
			<th>Time 9 = 87 &micro;s</th>
			<th>Voltage 9 = 3.46 V</th>
		</tr>
		<tr>	
			<th>Time 10 = 88 &micro;s</th>
			<th>Voltage 10 = 3.45 V</th>
		</tr>
		<tr>	
			<th>Time 11 = 89 &micro;s</th>
			<th>Voltage 11 = 3.43 V</th>
		</tr>
		<tr>
			<th>Time 12 = 90 &micro;s</th>
			<th>Voltage 12 = 3.41 V</th>
		</tr>	
		<tr>	
			<th>Time 13 = 91 &micro;s</th>
			<th>Voltage 13 = 3.38 V</th>
		</tr>
		<tr>	
			<th>Time 14 = 92 &micro;s</th>
			<th>Voltage 14 = 3.35 V</th>
		</tr>
		<tr>	
			<th>Time 15 = 93 &micro;s</th>
			<th>Voltage 15 = 3.31 V</th>
		</tr>	
		<tr>	
			<th>Time 16 = 94 &micro;s</th>
			<th>Voltage 16 = 3.25 V</th>
		</tr>	
		<tr>	
			<th>Time 17 = 95 &micro;s</th>
			<th>Voltage 17 = 3.18 V</th>
		</tr>
		<tr>	
			<th>Time 18 = 96 &micro;s</th>
			<th>Voltage 18 = 3.10 V</th>
		</tr>	
		<tr>	
			<th>Time 19 = 97 &micro;s</th>
			<th>Voltage 19 = 3.01 V</th>
		</tr>	
		<tr>	
			<th>Time 20 = 98 &micro;s</th>
			<th>Voltage 20 = 2.92 V</th>
		</tr>
		<tr>	
			<th>Time 21 = 99 &micro;s</th>
			<th>Voltage 21 = 2.83 V</th>
		</tr>
		<tr>	
			<th>Time 22 = 100 &micro;s</th>
			<th>Voltage 22 = 2.74 V</th>
		</tr>
	</table>
	<p align="center"><font size="-1"><i>Table 1: Time Value Pairs for V<sub>Bat</sub></i></font></p> <br />	
	
	<p align="center"><img src="Figure 3.jpg" width="100%" height="100%"></p>
	<p align="center"><font size="-1"><i>Figure 3: Transient Analysis of Lithium Ion Battery Simulation</i></font></p> <br />
	<p>	After the battery was built, output pins were attached and a transient analysis was simulated to ensure its correctness of behavior, as its decay was not strictly linear. 
		The simulation of the battery can be viewed in Figure 3. At a 100% state of charge, the battery is charged at 3.7 V. From 100% to 20%, the battery’s voltage decreases 
		linearly from 3.7 V to 3.5 V. From 20% to 0%, the battery’s voltage has an exponential decay from 3.5 V to 3 V. This output behavior can be used for signaling a 
		battery’s imminent failure by connecting a resistor with a value of 105 to 140 Ohms and an LED. The LED would shine when the battery’s voltage begins to drop quicker, 
		so it would begin to shine at below 20% and be brightest just before the battery begins to sustain damage, below the theoretical “0%.” </p>
	<p> The detection system’s design draws from Figure 27.2 and 27.5 from the class text, with some necessary modifications to realize the system’s desired behavior. 
		While the preamplification and decision circuit was indeed outlined in the text, the final stage of the circuit was not. The post-amplification stage needed to be 
		constructed from the inference that the stage was an output buffer. A basic buffer consisting of a modified inverter followed by a regular one was realized. 
		A total of 15 FETs were used in this circuit. </p>
	
	<p> FET sizing conventions from the text were considered, but some liberties were taken to better dictate the system’s behavior. The size ratios between all FETs were kept, 
		but the actual sizings needed to be recalculated. All FETs were sized with 25 fingers, a length of 0.03μm and a multiplier of 6. 
		All PFETs were sized with a 0.3μm width per finger. The bottommost NFET was given a width of 0.2μm per finger. All other NFETs were given a size of 0.1μm per finger. 
		Figure 4 shows the completed circuit and Figure 5 shows its behavior. </p> <br />
	<p align="center"><img src="Figure 4.jpg" width="100%" height="100%"></p>
	<p align="center"><font size="-1"><i>Figure 4: Voltage Comparator constructed in HSPICE</i></font></p> <br />
	<p align="center"><img src="Figure 5.jpg" width="100%" height="100%"></p>
	<p align="center"><font size="-1"><i>Figure 5: Transient Analysis of Voltage Comparator</i></font></p> <br />

	<p> After the comparator circuit was constructed in HSPICE and simulated, considerations were made for continuous battery sensing. The text was not used to construct 
		this circuit, as its use case was a bit too specific to expect to find. This design used four stages of the voltage comparator circuit to create four different stages 
		of battery charge indication. Aside from the four stages of comparators, no extra FETs were used. But a total of 12 resistors were added to the circuit, 
		totalling 60 FETs and 12 resistors for this circuit. Its behavior is similar to the comparator circuit, but has several levels of voltage that would be used 
		in the opposite manner. LEDs could be connected where the measurement pins were placed in the circuit, representing the charge level, but instead more would light up 
		when the system reads a higher charge rather than the LEDs being an indicator of an emergency. The circuit is shown in Figure 6 and its behavior is shown in Figure 7. </p> <br />
	<p align="center"><img src="Figure 6.jpg" width="100%" height="100%"></p> 
	<p align="center"><font size="-1"><i>Figure 6: Continuous Indicator constructed in HSPICE</i></font></p> <br />
	<p align="center"><img src="Figure 7.jpg" width="100%" height="100%"></p> 
	<p align="center"><font size="-1"><i>Figure 7: Transient Analysis of Continuous Indicator</i></font></p> 

	<h1 align="center"><b>Conclusion</b></h1>
	<p>	The challenges that the team endured included creating the definite exponential decay of the lithium ion battery and a continuous reading of the % charge of the battery. 
		A small portion of the project that gave the team a tough time was creating the exponential decay of the battery. At first, the group set a linear decay from 20% to 0%. 
		But after some tampering around with the time values of the piecewise-linear voltage source, the error was resolved by increasing the time values little by little 
		and decreased the voltages little by little, more like the exponential decay given in the specification sheet. This solution allowed the linear decay to transform into 
		the desired exponential decay. Moreover, most of the group’s time went into making modifications to the voltage comparator so that it could work efficiently with 
		the lithium ion battery. At first, it showed only the typical response of a comparator. In order to fix the error, an output buffer was connected to the voltage comparator 
		so that the simulation displayed would show the battery discharging and the comparator’s response to the discharge. </p>
	<p> Overall, the group learned how to build a lithium ion battery with a graphite anode, a voltage comparator, a continuous indicator, how to properly simulate all of them, 
		and also more on how to troubleshoot HSPICE errors. This design project was an opportunity to demonstrate finesse in HSPICE, Simulation and Analysis Environment (SAE), 
		and netlisting.	</p>
		
	<h1 align="center"><b>Sources</b></h1>
	<ul>
		<li><a href="http://americansolarchallenge.org/ASC/wp-content/uploads/2013/01/high_cell_count.pdf" target="_blank">High Cell Count</a></li>
		<li><a href="https://www.electroschematics.com/9937/3-7v-li-ion-battery-charger-circuit/" target="_blank">3.7 V Li-Ion Charger Circuit</a></li>
		<li><a href="https://www.electroschematics.com/10436/low-voltage-battery-level-indicator/" target="_blank">Low Voltage Battery Level Indicator</a></li>
		<li><a href="http://www.instructables.com/id/Li-Ion-battery-level-indicator/" target="_blank">Li-Ion Battery Level Indicator</a></li>
		<li><a href="https://www.electroschematics.com/6868/12v-battery-level-indicator-circuit/" target="_blank">12 V Battery Level Indicator Circuit</a></li>
		<li><a href="https://www.edn.com/electronics-blogs/living-analog/4394290/Capacitor-charge-transfer-" target="_blank">Capacitor Charge Transfer</a></li>
		<li><a href="https://www.slideshare.net/TsuyoshiHorigome/lithium-ion-battery-simplified-simulink-model-using-matlab?from_action=save" target="_blank">Lithium Ion Battery Simulink Model</a></li>
	</ul>
    </div>
</div>

<footer id="myFooter">
    <div class="w3-container w3-theme-l2 w3-padding-8">
      <h6>&copy; 2018 Jetchan204. All rights reserved.</h6>	
    </div>

<!--    <div class="w3-container w3-theme-l1">
      <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
    </div>	-->
  </footer>	

<!-- END MAIN -->

<!--
<script>
// Get the Sidebar
var mySidebar = document.getElementById("mySidebar");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidebar, and add overlay effect
function w3_open() {
  if (mySidebar.style.display === 'block') {
    mySidebar.style.display = 'none';
    overlayBg.style.display = "none";
  } else {
    mySidebar.style.display = 'block';
    overlayBg.style.display = "block";
  }
}

// Close the sidebar with the close button
function w3_close() {
  mySidebar.style.display = "none";
  overlayBg.style.display = "none";
}
</script>	-->

</body>
</html>
